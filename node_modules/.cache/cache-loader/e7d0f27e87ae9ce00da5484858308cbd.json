{"remainingRequest":"C:\\mine\\搭webpack环境\\so\\node_modules\\thread-loader\\dist\\cjs.js!C:\\mine\\搭webpack环境\\so\\node_modules\\babel-loader\\lib\\index.js!C:\\mine\\搭webpack环境\\so\\node_modules\\babel-loader\\lib\\index.js!C:\\mine\\搭webpack环境\\so\\node_modules\\async-validator\\es\\index.js","dependencies":[{"path":"C:\\mine\\搭webpack环境\\so\\node_modules\\async-validator\\es\\index.js","mtime":499162500000},{"path":"C:\\mine\\搭webpack环境\\so\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\mine\\搭webpack环境\\so\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\mine\\搭webpack环境\\so\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\mine\\搭webpack环境\\so\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9leHRlbmRzIGZyb20gJ2JhYmVsLXJ1bnRpbWUvaGVscGVycy9leHRlbmRzJzsKaW1wb3J0IF90eXBlb2YgZnJvbSAnYmFiZWwtcnVudGltZS9oZWxwZXJzL3R5cGVvZic7CmltcG9ydCB7IGZvcm1hdCwgY29tcGxlbWVudEVycm9yLCBhc3luY01hcCwgd2FybmluZywgZGVlcE1lcmdlIH0gZnJvbSAnLi91dGlsJzsKaW1wb3J0IHZhbGlkYXRvcnMgZnJvbSAnLi92YWxpZGF0b3IvJzsKaW1wb3J0IHsgbWVzc2FnZXMgYXMgZGVmYXVsdE1lc3NhZ2VzLCBuZXdNZXNzYWdlcyB9IGZyb20gJy4vbWVzc2FnZXMnOwovKioKICogIEVuY2Fwc3VsYXRlcyBhIHZhbGlkYXRpb24gc2NoZW1hLgogKgogKiAgQHBhcmFtIGRlc2NyaXB0b3IgQW4gb2JqZWN0IGRlY2xhcmluZyB2YWxpZGF0aW9uIHJ1bGVzCiAqICBmb3IgdGhpcyBzY2hlbWEuCiAqLwoKZnVuY3Rpb24gU2NoZW1hKGRlc2NyaXB0b3IpIHsKICB0aGlzLnJ1bGVzID0gbnVsbDsKICB0aGlzLl9tZXNzYWdlcyA9IGRlZmF1bHRNZXNzYWdlczsKICB0aGlzLmRlZmluZShkZXNjcmlwdG9yKTsKfQoKU2NoZW1hLnByb3RvdHlwZSA9IHsKICBtZXNzYWdlczogZnVuY3Rpb24gbWVzc2FnZXMoX21lc3NhZ2VzKSB7CiAgICBpZiAoX21lc3NhZ2VzKSB7CiAgICAgIHRoaXMuX21lc3NhZ2VzID0gZGVlcE1lcmdlKG5ld01lc3NhZ2VzKCksIF9tZXNzYWdlcyk7CiAgICB9CgogICAgcmV0dXJuIHRoaXMuX21lc3NhZ2VzOwogIH0sCiAgZGVmaW5lOiBmdW5jdGlvbiBkZWZpbmUocnVsZXMpIHsKICAgIGlmICghcnVsZXMpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY29uZmlndXJlIGEgc2NoZW1hIHdpdGggbm8gcnVsZXMnKTsKICAgIH0KCiAgICBpZiAoKHR5cGVvZiBydWxlcyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YocnVsZXMpKSAhPT0gJ29iamVjdCcgfHwgQXJyYXkuaXNBcnJheShydWxlcykpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCdSdWxlcyBtdXN0IGJlIGFuIG9iamVjdCcpOwogICAgfQoKICAgIHRoaXMucnVsZXMgPSB7fTsKICAgIHZhciB6ID0gdm9pZCAwOwogICAgdmFyIGl0ZW0gPSB2b2lkIDA7CgogICAgZm9yICh6IGluIHJ1bGVzKSB7CiAgICAgIGlmIChydWxlcy5oYXNPd25Qcm9wZXJ0eSh6KSkgewogICAgICAgIGl0ZW0gPSBydWxlc1t6XTsKICAgICAgICB0aGlzLnJ1bGVzW3pdID0gQXJyYXkuaXNBcnJheShpdGVtKSA/IGl0ZW0gOiBbaXRlbV07CiAgICAgIH0KICAgIH0KICB9LAogIHZhbGlkYXRlOiBmdW5jdGlvbiB2YWxpZGF0ZShzb3VyY2VfKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgIHZhciBvID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgIHZhciBvYyA9IGFyZ3VtZW50c1syXTsKICAgIHZhciBzb3VyY2UgPSBzb3VyY2VfOwogICAgdmFyIG9wdGlvbnMgPSBvOwogICAgdmFyIGNhbGxiYWNrID0gb2M7CgogICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIGNhbGxiYWNrID0gb3B0aW9uczsKICAgICAgb3B0aW9ucyA9IHt9OwogICAgfQoKICAgIGlmICghdGhpcy5ydWxlcyB8fCBPYmplY3Qua2V5cyh0aGlzLnJ1bGVzKS5sZW5ndGggPT09IDApIHsKICAgICAgaWYgKGNhbGxiYWNrKSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQoKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGZ1bmN0aW9uIGNvbXBsZXRlKHJlc3VsdHMpIHsKICAgICAgdmFyIGkgPSB2b2lkIDA7CiAgICAgIHZhciBmaWVsZCA9IHZvaWQgMDsKICAgICAgdmFyIGVycm9ycyA9IFtdOwogICAgICB2YXIgZmllbGRzID0ge307CgogICAgICBmdW5jdGlvbiBhZGQoZSkgewogICAgICAgIGlmIChBcnJheS5pc0FycmF5KGUpKSB7CiAgICAgICAgICBlcnJvcnMgPSBlcnJvcnMuY29uY2F0LmFwcGx5KGVycm9ycywgZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGVycm9ycy5wdXNoKGUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZm9yIChpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBhZGQocmVzdWx0c1tpXSk7CiAgICAgIH0KCiAgICAgIGlmICghZXJyb3JzLmxlbmd0aCkgewogICAgICAgIGVycm9ycyA9IG51bGw7CiAgICAgICAgZmllbGRzID0gbnVsbDsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZXJyb3JzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICBmaWVsZCA9IGVycm9yc1tpXS5maWVsZDsKICAgICAgICAgIGZpZWxkc1tmaWVsZF0gPSBmaWVsZHNbZmllbGRdIHx8IFtdOwogICAgICAgICAgZmllbGRzW2ZpZWxkXS5wdXNoKGVycm9yc1tpXSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBjYWxsYmFjayhlcnJvcnMsIGZpZWxkcyk7CiAgICB9CgogICAgaWYgKG9wdGlvbnMubWVzc2FnZXMpIHsKICAgICAgdmFyIG1lc3NhZ2VzID0gdGhpcy5tZXNzYWdlcygpOwoKICAgICAgaWYgKG1lc3NhZ2VzID09PSBkZWZhdWx0TWVzc2FnZXMpIHsKICAgICAgICBtZXNzYWdlcyA9IG5ld01lc3NhZ2VzKCk7CiAgICAgIH0KCiAgICAgIGRlZXBNZXJnZShtZXNzYWdlcywgb3B0aW9ucy5tZXNzYWdlcyk7CiAgICAgIG9wdGlvbnMubWVzc2FnZXMgPSBtZXNzYWdlczsKICAgIH0gZWxzZSB7CiAgICAgIG9wdGlvbnMubWVzc2FnZXMgPSB0aGlzLm1lc3NhZ2VzKCk7CiAgICB9CgogICAgdmFyIGFyciA9IHZvaWQgMDsKICAgIHZhciB2YWx1ZSA9IHZvaWQgMDsKICAgIHZhciBzZXJpZXMgPSB7fTsKICAgIHZhciBrZXlzID0gb3B0aW9ucy5rZXlzIHx8IE9iamVjdC5rZXlzKHRoaXMucnVsZXMpOwogICAga2V5cy5mb3JFYWNoKGZ1bmN0aW9uICh6KSB7CiAgICAgIGFyciA9IF90aGlzLnJ1bGVzW3pdOwogICAgICB2YWx1ZSA9IHNvdXJjZVt6XTsKICAgICAgYXJyLmZvckVhY2goZnVuY3Rpb24gKHIpIHsKICAgICAgICB2YXIgcnVsZSA9IHI7CgogICAgICAgIGlmICh0eXBlb2YgcnVsZS50cmFuc2Zvcm0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGlmIChzb3VyY2UgPT09IHNvdXJjZV8pIHsKICAgICAgICAgICAgc291cmNlID0gX2V4dGVuZHMoe30sIHNvdXJjZSk7CiAgICAgICAgICB9CgogICAgICAgICAgdmFsdWUgPSBzb3VyY2Vbel0gPSBydWxlLnRyYW5zZm9ybSh2YWx1ZSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodHlwZW9mIHJ1bGUgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIHJ1bGUgPSB7CiAgICAgICAgICAgIHZhbGlkYXRvcjogcnVsZQogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcnVsZSA9IF9leHRlbmRzKHt9LCBydWxlKTsKICAgICAgICB9CgogICAgICAgIHJ1bGUudmFsaWRhdG9yID0gX3RoaXMuZ2V0VmFsaWRhdGlvbk1ldGhvZChydWxlKTsKICAgICAgICBydWxlLmZpZWxkID0gejsKICAgICAgICBydWxlLmZ1bGxGaWVsZCA9IHJ1bGUuZnVsbEZpZWxkIHx8IHo7CiAgICAgICAgcnVsZS50eXBlID0gX3RoaXMuZ2V0VHlwZShydWxlKTsKCiAgICAgICAgaWYgKCFydWxlLnZhbGlkYXRvcikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgc2VyaWVzW3pdID0gc2VyaWVzW3pdIHx8IFtdOwogICAgICAgIHNlcmllc1t6XS5wdXNoKHsKICAgICAgICAgIHJ1bGU6IHJ1bGUsCiAgICAgICAgICB2YWx1ZTogdmFsdWUsCiAgICAgICAgICBzb3VyY2U6IHNvdXJjZSwKICAgICAgICAgIGZpZWxkOiB6CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSk7CiAgICB2YXIgZXJyb3JGaWVsZHMgPSB7fTsKICAgIGFzeW5jTWFwKHNlcmllcywgb3B0aW9ucywgZnVuY3Rpb24gKGRhdGEsIGRvSXQpIHsKICAgICAgdmFyIHJ1bGUgPSBkYXRhLnJ1bGU7CiAgICAgIHZhciBkZWVwID0gKHJ1bGUudHlwZSA9PT0gJ29iamVjdCcgfHwgcnVsZS50eXBlID09PSAnYXJyYXknKSAmJiAoX3R5cGVvZihydWxlLmZpZWxkcykgPT09ICdvYmplY3QnIHx8IF90eXBlb2YocnVsZS5kZWZhdWx0RmllbGQpID09PSAnb2JqZWN0Jyk7CiAgICAgIGRlZXAgPSBkZWVwICYmIChydWxlLnJlcXVpcmVkIHx8ICFydWxlLnJlcXVpcmVkICYmIGRhdGEudmFsdWUpOwogICAgICBydWxlLmZpZWxkID0gZGF0YS5maWVsZDsKCiAgICAgIGZ1bmN0aW9uIGFkZEZ1bGxmaWVsZChrZXksIHNjaGVtYSkgewogICAgICAgIHJldHVybiBfZXh0ZW5kcyh7fSwgc2NoZW1hLCB7CiAgICAgICAgICBmdWxsRmllbGQ6IHJ1bGUuZnVsbEZpZWxkICsgJy4nICsga2V5CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGNiKCkgewogICAgICAgIHZhciBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBbXTsKICAgICAgICB2YXIgZXJyb3JzID0gZTsKCiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KGVycm9ycykpIHsKICAgICAgICAgIGVycm9ycyA9IFtlcnJvcnNdOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVycm9ycy5sZW5ndGgpIHsKICAgICAgICAgIHdhcm5pbmcoJ2FzeW5jLXZhbGlkYXRvcjonLCBlcnJvcnMpOwogICAgICAgIH0KCiAgICAgICAgaWYgKGVycm9ycy5sZW5ndGggJiYgcnVsZS5tZXNzYWdlKSB7CiAgICAgICAgICBlcnJvcnMgPSBbXS5jb25jYXQocnVsZS5tZXNzYWdlKTsKICAgICAgICB9CgogICAgICAgIGVycm9ycyA9IGVycm9ycy5tYXAoY29tcGxlbWVudEVycm9yKHJ1bGUpKTsKCiAgICAgICAgaWYgKG9wdGlvbnMuZmlyc3QgJiYgZXJyb3JzLmxlbmd0aCkgewogICAgICAgICAgZXJyb3JGaWVsZHNbcnVsZS5maWVsZF0gPSAxOwogICAgICAgICAgcmV0dXJuIGRvSXQoZXJyb3JzKTsKICAgICAgICB9CgogICAgICAgIGlmICghZGVlcCkgewogICAgICAgICAgZG9JdChlcnJvcnMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBpZiBydWxlIGlzIHJlcXVpcmVkIGJ1dCB0aGUgdGFyZ2V0IG9iamVjdAogICAgICAgICAgLy8gZG9lcyBub3QgZXhpc3QgZmFpbCBhdCB0aGUgcnVsZSBsZXZlbCBhbmQgZG9uJ3QKICAgICAgICAgIC8vIGdvIGRlZXBlcgogICAgICAgICAgaWYgKHJ1bGUucmVxdWlyZWQgJiYgIWRhdGEudmFsdWUpIHsKICAgICAgICAgICAgaWYgKHJ1bGUubWVzc2FnZSkgewogICAgICAgICAgICAgIGVycm9ycyA9IFtdLmNvbmNhdChydWxlLm1lc3NhZ2UpLm1hcChjb21wbGVtZW50RXJyb3IocnVsZSkpOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZXJyb3IpIHsKICAgICAgICAgICAgICBlcnJvcnMgPSBbb3B0aW9ucy5lcnJvcihydWxlLCBmb3JtYXQob3B0aW9ucy5tZXNzYWdlcy5yZXF1aXJlZCwgcnVsZS5maWVsZCkpXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBlcnJvcnMgPSBbXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIGRvSXQoZXJyb3JzKTsKICAgICAgICAgIH0KCiAgICAgICAgICB2YXIgZmllbGRzU2NoZW1hID0ge307CgogICAgICAgICAgaWYgKHJ1bGUuZGVmYXVsdEZpZWxkKSB7CiAgICAgICAgICAgIGZvciAodmFyIGsgaW4gZGF0YS52YWx1ZSkgewogICAgICAgICAgICAgIGlmIChkYXRhLnZhbHVlLmhhc093blByb3BlcnR5KGspKSB7CiAgICAgICAgICAgICAgICBmaWVsZHNTY2hlbWFba10gPSBydWxlLmRlZmF1bHRGaWVsZDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBmaWVsZHNTY2hlbWEgPSBfZXh0ZW5kcyh7fSwgZmllbGRzU2NoZW1hLCBkYXRhLnJ1bGUuZmllbGRzKTsKCiAgICAgICAgICBmb3IgKHZhciBmIGluIGZpZWxkc1NjaGVtYSkgewogICAgICAgICAgICBpZiAoZmllbGRzU2NoZW1hLmhhc093blByb3BlcnR5KGYpKSB7CiAgICAgICAgICAgICAgdmFyIGZpZWxkU2NoZW1hID0gQXJyYXkuaXNBcnJheShmaWVsZHNTY2hlbWFbZl0pID8gZmllbGRzU2NoZW1hW2ZdIDogW2ZpZWxkc1NjaGVtYVtmXV07CiAgICAgICAgICAgICAgZmllbGRzU2NoZW1hW2ZdID0gZmllbGRTY2hlbWEubWFwKGFkZEZ1bGxmaWVsZC5iaW5kKG51bGwsIGYpKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhciBzY2hlbWEgPSBuZXcgU2NoZW1hKGZpZWxkc1NjaGVtYSk7CiAgICAgICAgICBzY2hlbWEubWVzc2FnZXMob3B0aW9ucy5tZXNzYWdlcyk7CgogICAgICAgICAgaWYgKGRhdGEucnVsZS5vcHRpb25zKSB7CiAgICAgICAgICAgIGRhdGEucnVsZS5vcHRpb25zLm1lc3NhZ2VzID0gb3B0aW9ucy5tZXNzYWdlczsKICAgICAgICAgICAgZGF0YS5ydWxlLm9wdGlvbnMuZXJyb3IgPSBvcHRpb25zLmVycm9yOwogICAgICAgICAgfQoKICAgICAgICAgIHNjaGVtYS52YWxpZGF0ZShkYXRhLnZhbHVlLCBkYXRhLnJ1bGUub3B0aW9ucyB8fCBvcHRpb25zLCBmdW5jdGlvbiAoZXJycykgewogICAgICAgICAgICBkb0l0KGVycnMgJiYgZXJycy5sZW5ndGggPyBlcnJvcnMuY29uY2F0KGVycnMpIDogZXJycyk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciByZXMgPSBydWxlLnZhbGlkYXRvcihydWxlLCBkYXRhLnZhbHVlLCBjYiwgZGF0YS5zb3VyY2UsIG9wdGlvbnMpOwoKICAgICAgaWYgKHJlcyAmJiByZXMudGhlbikgewogICAgICAgIHJlcy50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBjYigpOwogICAgICAgIH0sIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICByZXR1cm4gY2IoZSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sIGZ1bmN0aW9uIChyZXN1bHRzKSB7CiAgICAgIGNvbXBsZXRlKHJlc3VsdHMpOwogICAgfSk7CiAgfSwKICBnZXRUeXBlOiBmdW5jdGlvbiBnZXRUeXBlKHJ1bGUpIHsKICAgIGlmIChydWxlLnR5cGUgPT09IHVuZGVmaW5lZCAmJiBydWxlLnBhdHRlcm4gaW5zdGFuY2VvZiBSZWdFeHApIHsKICAgICAgcnVsZS50eXBlID0gJ3BhdHRlcm4nOwogICAgfQoKICAgIGlmICh0eXBlb2YgcnVsZS52YWxpZGF0b3IgIT09ICdmdW5jdGlvbicgJiYgcnVsZS50eXBlICYmICF2YWxpZGF0b3JzLmhhc093blByb3BlcnR5KHJ1bGUudHlwZSkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKGZvcm1hdCgnVW5rbm93biBydWxlIHR5cGUgJXMnLCBydWxlLnR5cGUpKTsKICAgIH0KCiAgICByZXR1cm4gcnVsZS50eXBlIHx8ICdzdHJpbmcnOwogIH0sCiAgZ2V0VmFsaWRhdGlvbk1ldGhvZDogZnVuY3Rpb24gZ2V0VmFsaWRhdGlvbk1ldGhvZChydWxlKSB7CiAgICBpZiAodHlwZW9mIHJ1bGUudmFsaWRhdG9yID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBydWxlLnZhbGlkYXRvcjsKICAgIH0KCiAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHJ1bGUpOwogICAgdmFyIG1lc3NhZ2VJbmRleCA9IGtleXMuaW5kZXhPZignbWVzc2FnZScpOwoKICAgIGlmIChtZXNzYWdlSW5kZXggIT09IC0xKSB7CiAgICAgIGtleXMuc3BsaWNlKG1lc3NhZ2VJbmRleCwgMSk7CiAgICB9CgogICAgaWYgKGtleXMubGVuZ3RoID09PSAxICYmIGtleXNbMF0gPT09ICdyZXF1aXJlZCcpIHsKICAgICAgcmV0dXJuIHZhbGlkYXRvcnMucmVxdWlyZWQ7CiAgICB9CgogICAgcmV0dXJuIHZhbGlkYXRvcnNbdGhpcy5nZXRUeXBlKHJ1bGUpXSB8fCBmYWxzZTsKICB9Cn07CgpTY2hlbWEucmVnaXN0ZXIgPSBmdW5jdGlvbiByZWdpc3Rlcih0eXBlLCB2YWxpZGF0b3IpIHsKICBpZiAodHlwZW9mIHZhbGlkYXRvciAhPT0gJ2Z1bmN0aW9uJykgewogICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgcmVnaXN0ZXIgYSB2YWxpZGF0b3IgYnkgdHlwZSwgdmFsaWRhdG9yIGlzIG5vdCBhIGZ1bmN0aW9uJyk7CiAgfQoKICB2YWxpZGF0b3JzW3R5cGVdID0gdmFsaWRhdG9yOwp9OwoKU2NoZW1hLm1lc3NhZ2VzID0gZGVmYXVsdE1lc3NhZ2VzOwpleHBvcnQgZGVmYXVsdCBTY2hlbWE7"},{"version":3,"sources":["C:\\mine\\搭webpack环境\\so\\node_modules\\async-validator\\es\\index.js"],"names":["messages","Schema","deepMerge","newMessages","define","_typeof","Array","z","item","rules","validate","_this","o","arguments","oc","source","options","callback","Object","i","field","errors","fields","results","add","arr","value","series","keys","rule","_extends","validator","errorFields","asyncMap","data","deep","fullField","key","e","warning","complementError","doIt","format","fieldsSchema","fieldSchema","addFullfield","schema","errs","res","cb","complete","getType","validators","getValidationMethod","messageIndex"],"mappings":"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","sourcesContent":["import _extends from 'babel-runtime/helpers/extends';\nimport _typeof from 'babel-runtime/helpers/typeof';\nimport { format, complementError, asyncMap, warning, deepMerge } from './util';\nimport validators from './validator/';\nimport { messages as defaultMessages, newMessages } from './messages';\n\n/**\n *  Encapsulates a validation schema.\n *\n *  @param descriptor An object declaring validation rules\n *  for this schema.\n */\nfunction Schema(descriptor) {\n  this.rules = null;\n  this._messages = defaultMessages;\n  this.define(descriptor);\n}\n\nSchema.prototype = {\n  messages: function messages(_messages) {\n    if (_messages) {\n      this._messages = deepMerge(newMessages(), _messages);\n    }\n    return this._messages;\n  },\n  define: function define(rules) {\n    if (!rules) {\n      throw new Error('Cannot configure a schema with no rules');\n    }\n    if ((typeof rules === 'undefined' ? 'undefined' : _typeof(rules)) !== 'object' || Array.isArray(rules)) {\n      throw new Error('Rules must be an object');\n    }\n    this.rules = {};\n    var z = void 0;\n    var item = void 0;\n    for (z in rules) {\n      if (rules.hasOwnProperty(z)) {\n        item = rules[z];\n        this.rules[z] = Array.isArray(item) ? item : [item];\n      }\n    }\n  },\n  validate: function validate(source_) {\n    var _this = this;\n\n    var o = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var oc = arguments[2];\n\n    var source = source_;\n    var options = o;\n    var callback = oc;\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    if (!this.rules || Object.keys(this.rules).length === 0) {\n      if (callback) {\n        callback();\n      }\n      return;\n    }\n    function complete(results) {\n      var i = void 0;\n      var field = void 0;\n      var errors = [];\n      var fields = {};\n\n      function add(e) {\n        if (Array.isArray(e)) {\n          errors = errors.concat.apply(errors, e);\n        } else {\n          errors.push(e);\n        }\n      }\n\n      for (i = 0; i < results.length; i++) {\n        add(results[i]);\n      }\n      if (!errors.length) {\n        errors = null;\n        fields = null;\n      } else {\n        for (i = 0; i < errors.length; i++) {\n          field = errors[i].field;\n          fields[field] = fields[field] || [];\n          fields[field].push(errors[i]);\n        }\n      }\n      callback(errors, fields);\n    }\n\n    if (options.messages) {\n      var messages = this.messages();\n      if (messages === defaultMessages) {\n        messages = newMessages();\n      }\n      deepMerge(messages, options.messages);\n      options.messages = messages;\n    } else {\n      options.messages = this.messages();\n    }\n    var arr = void 0;\n    var value = void 0;\n    var series = {};\n    var keys = options.keys || Object.keys(this.rules);\n    keys.forEach(function (z) {\n      arr = _this.rules[z];\n      value = source[z];\n      arr.forEach(function (r) {\n        var rule = r;\n        if (typeof rule.transform === 'function') {\n          if (source === source_) {\n            source = _extends({}, source);\n          }\n          value = source[z] = rule.transform(value);\n        }\n        if (typeof rule === 'function') {\n          rule = {\n            validator: rule\n          };\n        } else {\n          rule = _extends({}, rule);\n        }\n        rule.validator = _this.getValidationMethod(rule);\n        rule.field = z;\n        rule.fullField = rule.fullField || z;\n        rule.type = _this.getType(rule);\n        if (!rule.validator) {\n          return;\n        }\n        series[z] = series[z] || [];\n        series[z].push({\n          rule: rule,\n          value: value,\n          source: source,\n          field: z\n        });\n      });\n    });\n    var errorFields = {};\n    asyncMap(series, options, function (data, doIt) {\n      var rule = data.rule;\n      var deep = (rule.type === 'object' || rule.type === 'array') && (_typeof(rule.fields) === 'object' || _typeof(rule.defaultField) === 'object');\n      deep = deep && (rule.required || !rule.required && data.value);\n      rule.field = data.field;\n      function addFullfield(key, schema) {\n        return _extends({}, schema, {\n          fullField: rule.fullField + '.' + key\n        });\n      }\n\n      function cb() {\n        var e = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n        var errors = e;\n        if (!Array.isArray(errors)) {\n          errors = [errors];\n        }\n        if (errors.length) {\n          warning('async-validator:', errors);\n        }\n        if (errors.length && rule.message) {\n          errors = [].concat(rule.message);\n        }\n\n        errors = errors.map(complementError(rule));\n\n        if (options.first && errors.length) {\n          errorFields[rule.field] = 1;\n          return doIt(errors);\n        }\n        if (!deep) {\n          doIt(errors);\n        } else {\n          // if rule is required but the target object\n          // does not exist fail at the rule level and don't\n          // go deeper\n          if (rule.required && !data.value) {\n            if (rule.message) {\n              errors = [].concat(rule.message).map(complementError(rule));\n            } else if (options.error) {\n              errors = [options.error(rule, format(options.messages.required, rule.field))];\n            } else {\n              errors = [];\n            }\n            return doIt(errors);\n          }\n\n          var fieldsSchema = {};\n          if (rule.defaultField) {\n            for (var k in data.value) {\n              if (data.value.hasOwnProperty(k)) {\n                fieldsSchema[k] = rule.defaultField;\n              }\n            }\n          }\n          fieldsSchema = _extends({}, fieldsSchema, data.rule.fields);\n          for (var f in fieldsSchema) {\n            if (fieldsSchema.hasOwnProperty(f)) {\n              var fieldSchema = Array.isArray(fieldsSchema[f]) ? fieldsSchema[f] : [fieldsSchema[f]];\n              fieldsSchema[f] = fieldSchema.map(addFullfield.bind(null, f));\n            }\n          }\n          var schema = new Schema(fieldsSchema);\n          schema.messages(options.messages);\n          if (data.rule.options) {\n            data.rule.options.messages = options.messages;\n            data.rule.options.error = options.error;\n          }\n          schema.validate(data.value, data.rule.options || options, function (errs) {\n            doIt(errs && errs.length ? errors.concat(errs) : errs);\n          });\n        }\n      }\n\n      var res = rule.validator(rule, data.value, cb, data.source, options);\n      if (res && res.then) {\n        res.then(function () {\n          return cb();\n        }, function (e) {\n          return cb(e);\n        });\n      }\n    }, function (results) {\n      complete(results);\n    });\n  },\n  getType: function getType(rule) {\n    if (rule.type === undefined && rule.pattern instanceof RegExp) {\n      rule.type = 'pattern';\n    }\n    if (typeof rule.validator !== 'function' && rule.type && !validators.hasOwnProperty(rule.type)) {\n      throw new Error(format('Unknown rule type %s', rule.type));\n    }\n    return rule.type || 'string';\n  },\n  getValidationMethod: function getValidationMethod(rule) {\n    if (typeof rule.validator === 'function') {\n      return rule.validator;\n    }\n    var keys = Object.keys(rule);\n    var messageIndex = keys.indexOf('message');\n    if (messageIndex !== -1) {\n      keys.splice(messageIndex, 1);\n    }\n    if (keys.length === 1 && keys[0] === 'required') {\n      return validators.required;\n    }\n    return validators[this.getType(rule)] || false;\n  }\n};\n\nSchema.register = function register(type, validator) {\n  if (typeof validator !== 'function') {\n    throw new Error('Cannot register a validator by type, validator is not a function');\n  }\n  validators[type] = validator;\n};\n\nSchema.messages = defaultMessages;\n\nexport default Schema;"]}]}